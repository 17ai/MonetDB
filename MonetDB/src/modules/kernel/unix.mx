@t Unix standard library calls
@a Tim Ruhl, Martin Kersten
@v 0.1
@* Unix stdlib
The unix module is currently of rather limited size.
It should include only those facilities that are UNIX
specific, i.e. not portable to other platforms.
Similar modules may be defined for Windows platforms.
@-

@mal

module unix;

command getenv(nme:str) : str = unix_getenv
comment "Get the environment variable string.";

command setenv(nme:str,val:str) : bit = unix_setenv
comment "Set the environment variable string.";

command system(nme:str) : int = unix_system
comment "execute a command and give back the return value";

@-
The implementation is relatively straight forward.

@c
#include <gdk.h>

int unix_getenv(str *res, str *varname)
{
	char *p = getenv(*varname);
	if (p) {
		*res = GDKstrdup(p);
	} else {
		*res = GDKstrdup("");
	}
	return GDK_SUCCEED;
}

int unix_setenv(bit *res, str *varname, str *valname)
{
	*res = setenv(*varname, *valname, TRUE);
	return GDK_SUCCEED;
}

int unix_system(int *res, str *command)
{
	*res = system(*command);
	return GDK_SUCCEED;
}
