<!--
The contents of this file are subject to the Pathfinder Public License
Version 1.1 (the "License"); you may not use this file except in
compliance with the License.  You may obtain a copy of the License at
http://monetdb.cwi.nl/Legal/PathfinderLicense-1.1.html

Software distributed under the License is distributed on an "AS IS"
basis, WITHOUT WARRANTY OF ANY KIND, either express or implied.  See
the License for the specific language governing rights and limitations
under the License.

The Original Code is the Pathfinder system.

The Original Code has initially been developed by the Database &
Information Systems Group at the University of Konstanz, Germany and
is now maintained by the Database Systems Group at the Technische
Universitaet Muenchen, Germany.  Portions created by the University of
Konstanz and the Technische Universitaet Muenchen are Copyright (C)
2000-2005 University of Konstanz and (C) 2005-2008 Technische
Universitaet Muenchen, respectively.  All Rights Reserved.
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="nl">
<head>
 <title>SIGMOD 2008 - XRPC Demo</title>
 <script type="text/javascript" src="../admin/xrpcwebclient.js"></script>
 <script type="text/javascript">
  var clnt = new XRPCWebClient(); 

  function funcdef(n, u, a, q, d) {
	this.name = n;
	this.updating = u;
	this.arr = a;
	this.quantarr = q;
	this.def = d;

	this.getName = function() {
		return this.name;
	}
	
	this.getUpdating = function() {
		return this.updating;
	}
	
	this.getArrSize = function() {
		return this.arr.length;
	}
	
	this.getArr = function(i) {
		return this.arr[i];
	}
	
	this.getQArr = function(i) {
		return this.quantarr[i];
	}
	
	this.getArrDisplay = function(i) {
		if (this.arr[i] == "string") return "xs:string";
		if (this.arr[i] == "integer") return "xs:integer";
		return this.arr[i];
	}
	
	this.getDef = function() {
		return this.def;
	}
  }
  
  var funcdefs = new Array();
  funcdefs[funcdefs.length]=new funcdef("add", false, new Array("integer", "integer"), new Array("", ""), "declare function f:add($v1 as xs:integer, $v2 as xs:integer) as xs:integer\n{ $v1 + $v2 };");
  funcdefs[funcdefs.length]=new funcdef("addSeq", false, new Array("integer", "integer"), new Array("+", "+"), "declare function f:addSeq($v1 as xs:integer+, $v2 as xs:integer+) as xs:integer\n{ for $vi in $v1, $vj in $v2 return $vi + $vj };");
  funcdefs[funcdefs.length]=new funcdef("firstPerson", false, new Array("string"), new Array(""), "declare function f:firstPerson($doc as xs:string) as node()\n{ exactly-one(doc($doc)//person[1]) };");
  funcdefs[funcdefs.length]=new funcdef("firstPerson", false, new Array("string", "string"), new Array("+", "+"), "declare function f:firstPerson($docs as xs:string+, $dsts as xs:string+) as node()+\n{ for $d at $pos in $dsts\n  return execute at {$d} {f:firstPerson(exactly-one($docs[$pos]))}\n};");
  funcdefs[funcdefs.length]=new funcdef("boughtItems", false, new Array("string", "string"), new Array("", ""), "declare function f:boughtItems($pid as xs:string, $doc as xs:string) as node()*\n{ doc($doc)//closed_auction[./buyer/@person=$pid] };");
  funcdefs[funcdefs.length]=new funcdef("boughtItemsSeq", false, new Array("string", "string"), new Array("+", ""), "declare function f:boughtItemsSeq($pid as xs:string+, $doc as xs:string) as node()*\n{ for $p in $pid\n  return\n    doc($doc)//closed_auction[./buyer/@person=$p]\n};");
  funcdefs[funcdefs.length]=new funcdef("boughtItemsAllPersons", false, new Array("string", "string", "string"), new Array("", "", ""), "declare function f:boughtItemsAllPersons($docL as xs:string, $docR as xs:string, $dst as xs:string) as node()*\n{ for $p in $pid\n  return\n  	for $ca in doc($doc)//closed_auction[./buyer/@person=$p]\n  	return\nelement closed_auction {attribute buyer {$ca/buyer/@person}, $ca/price, $ca/date}\n};");
  funcdefs[funcdefs.length]=new funcdef("insertPerson", true, new Array("node()", "string"), new Array("", ""), "declare updating function f:insertPerson($p as node(), $doc as xs:string)\n{ do insert $p into doc($doc)//persons };");
  funcdefs[funcdefs.length]=new funcdef("deletePerson", true, new Array("string", "string"), new Array("", ""), "declare updating function f:deletePerson($pid as xs:string, $doc as xs:string)\n{ do delete doc($doc)//person[./@pid=$pid] };");
  funcdefs[funcdefs.length]=new funcdef("custom...", false, new Array("integer", "integer", "integer", "integer"), new Array("", "", "", ""), "");
  
  var par_types = new Array("integer", "string", "node()");
  var par_types_display = new Array("xs:integer", "xs:string", "node()");
  var quant_types = new Array("", "?", "+", "*");
  var example_nodes = new Array("<person>Schaap<\/person>", "John Denver", "Elvis Presley", "Shania Twain");
  
  function fillPostUrlBox() {
  	var obj = document.getElementById("postUrl");
	obj.value = "http://" + window.location.hostname + ":" + window.location.port + "/xrpc";
  }
  
  function fillLocationBox() {
  	var obj = document.getElementById("loc");
  	obj.value = "http://" + window.location.hostname + ":" + window.location.port + "/demo/demo-mod.xq";
  }

  function fillMethodBox() {
  	var obj = document.getElementById("method");
	obj.options.length = 0;
	for (var j = 0; j < funcdefs.length; j++) {
		var temp = new Option(funcdefs[j].getName(), funcdefs[j].getName());
		obj.options[obj.options.length] = temp;
	}
	obj.selectedIndex = 0;
  }
  
  function getParam(tpe, quant, val) {
  	if (quant == "")
    	return XRPC_SEQ((tpe == "node()")?XRPC_ELEMENT(val):XRPC_ATOM(tpe,val));
    else {
    	var l = val.length;
    	var sval = val.substring(1, l - 1);
    	var vals = sval.split(",");
    	var seq = "";
    	for (var i = 0; i < vals.length; i++) {
    		vals[i] = vals[i].split(" ").join(""); // this removes whitespace
    		seq += (tpe == "node()")?XRPC_ELEMENT(vals[i]):XRPC_ATOM(tpe,vals[i]);
    	}
    	return XRPC_SEQ(seq);
    }
  }

  function sendRequest(form)  {
	//var obj = document.getElementById("answer");
    //obj.value = "Waiting for server response...";
    var obj = document.getElementById("messreq");
    obj.value = "";
    var obj = document.getElementById("messres");
    obj.value = "";

    var params = "";
    var xrpc_call = "";
    /* XRPCDEBUG makes you get an alert for each SOAP message sent/received */
    //XRPCDEBUG = form.debug.checked;
    
    if (form.method.selectedIndex == 0) {
	    for (var l = 0; l < form.loop.value; l++) {
	    	params = "";
		    for (var i = 1; i <= form.arity.value; i++) {
		      var value = parseInt(document.getElementById("param" + i).value) + l;
		   	  params += getParam(document.getElementById("type" + i).value, document.getElementById("quant" + i).value, value + '');
		   	}
		   	xrpc_call += XRPC_CALL(params);
		}
	} else {
	   	for (var l = 0; l < form.loop.value; l++) {
	    	params = "";
		    for (var i = 1; i <= form.arity.value; i++) {
		   	  params += getParam(document.getElementById("type" + i).value, document.getElementById("quant" + i).value, document.getElementById("param" + i).value);
		   	}
		   	xrpc_call += XRPC_CALL(params);
		}
	}
	
	var mode = form.isolevel.value + form.mode.value + (XRPCDEBUG?"-trace":"");
   	  
    XRPC(form.postUrl.value, form.ns.value, form.loc.value, 
         form.method.value, form.arity.value, xrpc_call, showResponse, form.timeout.value, mode);
  }
  
  function sendRequestPart(obj) {
  	var url = obj.alt;
  	var req = true;
  	if (url.indexOf("res") != -1) req = false;
  	//alert(req);
  	/* XRPCDEBUG makes you get an alert for each SOAP message sent/received */
    //XRPCDEBUG = document.getElementById("debug").checked;
  	XRPC_PART(obj.alt, req? messreqChanged: messresChanged);
  }

  function showResponse(response) {
    /*var obj = document.getElementById("answer");
    var obj2 = document.getElementById("updating");
    if (!obj2.checked) { // not updating function
    	var nodes = getnodesXRPC(response,"sequence");
    	var text = "";
    	for (var i = 0; i < nodes.length; i++) {
    		if (i > 0) text += ", ";
    		for (var c = 0; c < nodes[i].childNodes.length; c++) {
    			text += serializeXML(nodes[i].childNodes[c].firstChild);
    		}
    	}
  		obj.value = text;
  	} else {
  		obj.value = "Update succeeded (an updating function returns no answer).";
  	}*/
  }
  
  function methodChanged(object) {
  	var val = object.value;
  	var idx = object.selectedIndex;
  	var params = funcdefs[idx].getArrSize();
  	var def = funcdefs[idx].getDef();
  	var defobj = document.getElementById("def");
  	defobj.value = def;
  	var obj = document.getElementById("arity");
  	obj.value = params;
  	var par = document.getElementById("params");
  	var html = "<table cellpadding=\"0\" cellspacing=\"0\">";
  	var last = (idx == funcdefs.length - 1);
  	for (var i = 0; i < params; i++) {
  		html += "<tr><td>";
  		html += "<select name=\"type" + (i+1) + "\" id=\"type" + (i+1) + "\">";
  		if (!last) {
  			html += "<option value=\"" + funcdefs[idx].getArr(i) + "\">" + funcdefs[idx].getArrDisplay(i) + "<\/option>";
		} else {
			for (var j = 0; j < par_types.length; j++) {
	  			var s = funcdefs[idx].getArr(i) == par_types[j];
	  			var sel = s? " selected=\"selected\"": "";
	  			html += "<option value=\"" + par_types[j] + "\""+ sel + ">" + par_types_display[j] + "<\/option>";
	  		}
		}
  		html += "<\/select>";
  		html += "<\/td><td>&nbsp;";
  		
  		html += "<select name=\"quant" + (i+1) + "\" id=\"quant" + (i+1) + "\">";
  		if (!last) {
  			html += "<option value=\"" + funcdefs[idx].getQArr(i) + "\">" + funcdefs[idx].getQArr(i) + "&nbsp;<\/option>";
		} else {
			for (var j = 0; j < quant_types.length; j++) {
	  			var s = funcdefs[idx].getQArr(i) == quant_types[j];
	  			var sel = s? " selected=\"selected\"": "";
	  			html += "<option value=\"" + quant_types[j] + "\""+ sel + ">" + quant_types[j] + "&nbsp;<\/option>";
	  		}
		}
  		html += "<\/select>";
  		html += "<\/td><td>&nbsp;";
  		
  		var default_val = -1;
  		if (funcdefs[idx].getArr(i) == "integer") {
  			if (funcdefs[idx].getQArr(i) == "")
  				default_val = (i + 1);
  			else
  				default_val = "(" + (i*3+1) + ", " + (i*3+2) + ", " + (i*3+3) + ")";
  		}
  		if (funcdefs[idx].getArr(i) == "string") {
  			if (funcdefs[idx].getQArr(i) == "")
  				default_val = "xmark.xml"; //String.fromCharCode(65 + i);
  			else
  				default_val = "(" + String.fromCharCode(65 + i*3) + ", " + String.fromCharCode(66 + i*3) + ", " + String.fromCharCode(67 + i*3) + ")";
  		}
  		if (funcdefs[idx].getArr(i) == "node()") {
  			if (funcdefs[idx].getQArr(i) == "")
  				default_val = default_val = example_nodes[i];
  			else
  				default_val = "(" + example_nodes[i] + ", " + example_nodes[i] + ", " + example_nodes[i] + ")";
  		}
  		html += "<input type=\"text\" name=\"param" + (i+1) + "\" id=\"param" + (i+1) + "\" value=\"" + default_val + "\" />";
  		html += "<\/td><\/tr>";
  	}
  	html += "<\/table>";
  	par.innerHTML = html;
  	
  	defobj.readOnly = !last;
  	
  	var updobj = document.getElementById("updating");
  	updobj.checked = funcdefs[idx].getUpdating();
  	
  	//var loopobj = document.getElementById("loop");
  	//loopobj.disabled = (idx != 0);
  }
  
  /*function debugChanged(object) {
  	var debug = object.checked;
  	var objl = document.getElementById("content");
  	var objg = document.getElementById("graph");
  	var objr = document.getElementById("messages");
  	if (debug) {
  		objr.style.display = "block";
  		objg.style.display = "block";
  	} else {
  		objr.style.display = "none";
  		objg.style.display = "none";
  	}
  }*/
  
  function clickreq(vis) {
  	var objv = document.getElementById("reqvis");
  	var objr = document.getElementById("reqraw");
  	objv.style.display = vis?"block":"none";
  	objr.style.display = vis?"none":"block";
  }
  
  function clickres(vis) {
  	var objv = document.getElementById("resvis");
  	var objr = document.getElementById("resraw");
  	objv.style.display = vis?"block":"none";
  	objr.style.display = vis?"none":"block";
  }
  
  function isolevelChanged(object) {
  	var lev = object.value;
  	var obj = document.getElementById("timeout");
  	if (lev == "none") {
  		obj.value = "0";
  		obj.readOnly = true;
  	} else {
  		obj.value = "100";
  		obj.readOnly = false;
  	} 
  }
  
  function updatingChanged(object) { 
  }
  
  function escapeForHTML(s) {
  	return s.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")
  }
  
  function messreqChanged(xmldoc) {
  	document.getElementById("messreq").value = serializeXML(xmldoc);
  
  	var obj = document.getElementById("reqvis");
  	obj.innerHTML = "changed";
  	//var xpe = new XPathEvaluator();
	//var nsResolver = xpe.createNSResolver(xmldoc.ownerDocument == null ? xmldoc.documentElement : xmldoc.ownerDocument.documentElement);
  	//var oid = document.evaluate('/env:Envelope/env:Header/wscoor:CoordinationContext/wscoor:Identifier/text()', xmldoc, nsResolver, XPathResult.ANY_TYPE, null);
  	var qid = xmldoc.getElementsByTagName("Identifier")[0].firstChild.nodeValue;
  	var reqnode = xmldoc.getElementsByTagName("Body")[0].firstChild;
  	var funcn = reqnode.getAttribute("xrpc:method");
  	var ns = reqnode.getAttribute("xrpc:module");
  	var loc = reqnode.getAttribute("xrpc:location");
  	var htm =
  		'<table>' +
  		'<tr><td>QID<\/td><td>' + qid + '<\/td><\/tr>' +
  		'<tr><td>Function<\/td><td>' + funcn + '<\/td><\/tr>' +
  		'<tr><td>NS<\/td><td>' + ns + '<\/td><\/tr>' +
  		'<tr><td>Loc<\/td><td>' + loc + '<\/td><\/tr>' +
  		'</table><table><tr><td>iter<\/td><td>param<\/td><\/tr>';
  	var callnodes = xmldoc.getElementsByTagName("call");
  	for (var i = 0; i < callnodes.length; i++) {
  		var seqnodes = callnodes[i].childNodes;
  		var sval = '';
  		for (var k = 0; k < seqnodes.length; k++) {
	  		var atvals = seqnodes[k].childNodes;
	  		if (k > 0) sval += ', ';
	  		sval += '( ';
	  		for (var j = 0; j < atvals.length; j++) {
	  		 	if (j > 0) sval += ', ';
	  		 	var tval = atvals[j].firstChild.nodeValue;
	  			if (tval == null) tval = escapeForHTML(serializeXML(atvals[j].firstChild));
	  		 	sval += tval + ' ';
	  		}
	  		sval += ') ';
	  	}
	  	htm += '<tr><td>' + (i+1) + '<\/td><td>' + sval + '<\/td><\/tr>';
  	}
  	htm += '<\/table>';
  	
  	obj.innerHTML = htm;
  }
  
  function messresChanged(xmldoc) {
  	document.getElementById("messres").value = serializeXML(xmldoc);
  
  	var obj = document.getElementById("resvis");
  	obj.innerHTML = "changed";
  	var qid = 'UNKNOWN';
  	try {qid = xmldoc.getElementsByTagName("Identifier")[0].firstChild.nodeValue;} catch(err) {}
  	var reqnode = xmldoc.getElementsByTagName("Body")[0].firstChild;
  	var funcn = reqnode.getAttribute("xrpc:method");
  	var ns = reqnode.getAttribute("xrpc:module");
  	var htm =
  		'<table>' +
  		'<tr><td>QID<\/td><td>' + qid + '<\/td><\/tr>' +
  		'<tr><td>Function<\/td><td>' + funcn + '<\/td><\/tr>' +
  		'<tr><td>NS<\/td><td>' + ns + '<\/td><\/tr>' +
  		'<tr><td>&nbsp;<\/td><td><\/td><\/tr>' +
  		'</table><table><tr><td>iter<\/td><td>result<\/td><\/tr>';
  		var seqnodes = xmldoc.getElementsByTagName("response")[0].childNodes;
  		
  		for (var k = 0; k < seqnodes.length; k++) {
	  		var atvals = seqnodes[k].childNodes;
	  		var sval = '( ';
	  		for (var j = 0; j < atvals.length; j++) {
	  		 	if (j > 0) sval += ', ';
	  			var tval = atvals[j].firstChild.nodeValue;
	  			if (tval == null) tval = escapeForHTML(serializeXML(atvals[j].firstChild));
	  		 	sval += tval + ' ';
	  		}
	  		sval += ') ';
	  		htm += '<tr><td>' + (k+1) + '<\/td><td>' + sval + '<\/td><\/tr>';
	  	}
	  	
  	htm += '<\/table>';
  	
  	obj.innerHTML = htm;
  }
  
  function loadTreeMap(xmldoc) {
  	var obj = document.getElementById("treemap");
  }
  
  function init() {
  	XRPCDEBUG = true;
  	fillPostUrlBox();
 	fillLocationBox();
	fillMethodBox();
	clickreq(true);
	clickres(true);
 	methodChanged(document.getElementById("method"));
 	//debugChanged(document.getElementById("debug"));
  }
 </script>
 <link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body onload="init()">
<table id="header">
<tr>
<td>
	<a href="http://www.multimedian.nl" title="MultimediaN" target="_blank"><img src="MultimediaN.png" border="0" /></a>
</td>
<td>
	<h1>XRPC - Interoperable and Efficient distributed XQuery</h1>
</td>
<td>
	<a href="http://monetdb.cwi.nl" title="MonetDB is a high-performance open-source SQL and XQuery database system, developed by CWI" target="_blank"><img src="monet.png" border="0" /></a>
</td>
<td>
	<a href="http://www.cwi.nl" title="CWI is the Dutch national center for Computer Science and Mathematics Research" target="_blank"><img src="cwi.bmp" border="0" /></a>
</td>
</tr>
</table>

<form name="form" action="actionaddress">
<input type="hidden" name="arity" id="arity" />
<table id="all" cellpadding="0" cellspacing="0">
<tr><td>
	<table id="content">
	<tr>
		<td><label for="postUrl">XRPC server URL</label></td>
		<td><input type="text" name="postUrl" id="postUrl" value="" size="40" readonly="readonly" /></td>
	</tr>
	<tr>
		<td><label for="ns">Module namespace</label></td>
		<td><input type="text" name="ns" value="xrpcdemo-functions" size="40" /></td>
	</tr>
	<tr>
		<td><label for="loc">Module location</label></td>
		<td><input type="text" name="loc" id="loc" value="" size="40" /></td>
	</tr>
	<tr>
		<td><label for="method">Function</label></td>
		<td>
			<select name="method" id="method" onchange="methodChanged(this);">
			</select>
		</td>
	</tr>
	<tr>
		<td></td>
		<td><textarea cols="40" rows="14" name="def" id="def" readonly="readonly"></textarea></td>
	</tr>
	<tr>
		<td><label for="loop">Loop counter</label></td>
		<td>
			<input type="text" name="loop" id="loop" value="1" size="6" />
			&nbsp;&nbsp;&nbsp;&nbsp;
			Mode <select name="mode" id="mode">
					<option value="">all-at-once</option>
					<option value="-iterative">one-at-a-time</option>
				</select>
		</td>
	</tr>
	<tr style="height:100px">
		<td>Parameters</td>
		<td id="params">
		</td>
	</tr>
	<tr>
		<td><label for="updating">Updating Function</label></td>
		<td><input type="checkbox" name="updating" id="updating" onchange="updatingChanged(this)" /></td>
	</tr>
	<tr>
		<td><label for="isolevel">Isolation Level</label></td>
		<td>
			<select name="isolevel" id="isolevel" onchange="isolevelChanged(this);">
				<option value="none">None</option>
				<option value="repeatable">Repeatable</option>
			</select>
			&nbsp;&nbsp;&nbsp;&nbsp;
			Timeout <input type="text" value="0" name="timeout" id="timeout" readonly="readonly" size="10" />
		</td>
	</tr>
	<!--<tr>
		<td><label for="debug">Show query flow</label></td>
		<td><input type="checkbox" name="debug" id="debug" checked="checked" onchange="debugChanged(this)" /></td>
	</tr>-->
	<tr>
		<td></td>
		<td><input type="button" value="Submit" onclick="sendRequest(this.form)" /></td>
	</tr>
	</table>
	<!--<table id="answers">
	<tr class="myheader">
		<td>ANSWER<br /><textarea cols="65" rows="7" name="answer" id="answer" readonly="readonly"></textarea></td>
	</tr>
	</table>-->
</td>
<td>
	<div id="graph">
		<map name="treemap" id="treemap">
			<area shape="rect" onclick="sendRequestPart(this)" href="#" title="5ms" alt="http://127.0.0.1:50001/demo/res1.xml" coords="133,229,141,237"/>
			<area shape="rect" onclick="sendRequestPart(this)" href="#" title="5ms" alt="http://127.0.0.1:50001/demo/req1.xml" coords="100,356,108,364"/>
			<area shape="rect" onclick="sendRequestPart(this)" href="#" title="7ms" alt="http://127.0.0.1:50001/demo/res1.xml" coords="153,229,161,237"/>
			<area shape="rect" onclick="sendRequestPart(this)" href="#" title="7ms" alt="http://127.0.0.1:50001/demo/req1.xml" coords="205,356,213,364"/>
			<area shape="rect" onclick="sendRequestPart(this)" href="#" title="9ms" alt="http://127.0.0.1:50001/demo/res1.xml" coords="140,53,148,61"/>
			<area shape="rect" onclick="sendRequestPart(this)" href="#" title="9ms" alt="http://127.0.0.1:50001/demo/req1.xml" coords="140,181,148,189"/>
			<area shape="rect" onclick="sendRequestPart(this)" href="#" title="3ms" alt="http://127.0.0.1:50001/demo/res1.xml" coords="95,404,103,412"/>
			<area shape="rect" onclick="sendRequestPart(this)" href="#" title="3ms" alt="http://127.0.0.1:50001/demo/req1.xml" coords="99,532,107,540"/>
			<area shape="rect" onclick="sendRequestPart(this)" href="#" title="2ms" alt="http://127.0.0.1:50001/demo/res1.xml" coords="213,404,221,412"/>
			<area shape="rect" onclick="sendRequestPart(this)" href="#" title="2ms" alt="http://127.0.0.1:50001/demo/req1.xml" coords="211,532,219,540"/>
		</map>
		<table id="graphtable">
		<tr>
			<td><img id="treeimg" src="test.gif" usemap="#treemap" border="0" alt="messageflow" /></td>
		</tr>
		</table>
	</div>
</td>
<td>
	<div id="messages">
		<table id="request">
		<tr class="myheader">
			<td>REQUEST</td>
			<td class="tab"><a href="#" onclick="clickreq(true)">VISUAL</a></td>
			<td class="tab"><a href="#" onclick="clickreq(false)">RAW</a></td>
		</tr>
		<tr>
			<td colspan="3">
				<div id="reqraw">
					<textarea cols="48" rows="15" name="messreq" id="messreq" readonly="readonly"></textarea>
				</div>
				<div id="reqvis">
					visual display
				</div>
			</td>
		</tr>
		</table>
		<table id="response">
		<tr class="myheader">
			<td>RESPONSE</td>
			<td class="tab"><a href="#" onclick="clickres(true)">VISUAL</a></td>
			<td class="tab"><a href="#" onclick="clickres(false)">RAW</a></td>
		</tr>
		<tr>
			<td colspan="3">
				<div id="resraw">
					<textarea cols="48" rows="15" name="messres" id="messres" readonly="readonly"></textarea>
				</div>
				<div id="resvis">
					visual display
				</div>
			</td>
		</tr>
		</table>
	</div>
</td>
</tr>
</table>	
</form>
</body>
</html>
