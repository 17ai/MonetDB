



# read data from a CSV file using the Python PANDAS library and store it in a BAT
# requires python-pandas to be installed
# CSV location is hardcoded (sorry) ----->---------->----------->-------->------vvvv
r:bat[:oid,:int] := pyapi.eval(nil:ptr, "import pandas as pd\ndf = pd.read_csv(\"/home/mytherin/Programs/MonetDB/monetdb5/extras/pyapi/Tests/bikedata.csv\")\nreturn([list(df['Berri 1'])])");
io.print(r);

# use pandas to perform data aggregation
g:= bat.new(:oid,:int);
bat.append(g,1);
bat.append(g,2);
bat.append(g,3);
bat.append(g,1);
bat.append(g,2);
bat.append(g,3);
bat.append(g,1);
bat.append(g,2);
bat.append(g,3);
bat.append(g,1);

b:= bat.new(:oid,:dbl);
bat.append(b,1804289383:dbl);
bat.append(b,846930886:dbl);
bat.append(b,1681692777:dbl);
bat.append(b,1714636915:dbl);
bat.append(b,1957747793:dbl);
bat.append(b,424238335:dbl);
bat.append(b,719885386:dbl);
bat.append(b,1649760492:dbl);
bat.append(b,596516649:dbl);
bat.append(b,1189641421:dbl);

(r:bat[:oid,:int], s:bat[:oid,:dbl]) := pyapi.eval(nil:ptr,"import pandas as pd\ndf = pd.DataFrame({\'Group\': arg1, \'Values\': arg2})\ngrouped = df.groupby('Group')\nreturn([grouped.groups.keys(),grouped.sum().values.flatten()])", g, b);

io.print(r,s);
